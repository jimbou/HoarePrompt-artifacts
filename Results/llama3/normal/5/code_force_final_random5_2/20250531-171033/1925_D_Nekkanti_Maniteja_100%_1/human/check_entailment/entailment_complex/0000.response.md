Reasoning:

The given Python program is correct based on the problem description and the execution states of the program provided as comments. Here's why:

1. The program correctly reads the input for each test case, which consists of three integers (n, m, k) and then m lines of three integers each.

2. It calculates the modular inverse of the total number of possible pairs (n * (n - 1) // 2) modulo M (10^9 + 7) and stores it in the variable 'c'. This is correct because the modular inverse is used to calculate the probability of choosing a pair of friends.

3. It initializes the variable 's' to 0, which will store the expected value of the sum of friendship values of all k pairs chosen for the excursions.

4. It calculates the sum of the initial friendship values of all pairs of friends and stores it in the variable 'a'.

5. It then calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. This is done by iterating over each excursion (from 0 to k-1) and adding the product of the probability of choosing a pair of friends (c * i * c * m) and the sum of the initial friendship values (c * a) to 's'. This is correct because the expected value is the sum of the products of the probability of each outcome and the value of each outcome.

6. Finally, it prints the result modulo M (10^9 + 7), which is the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Therefore, the given Python program is correct.

Correctness: **True**