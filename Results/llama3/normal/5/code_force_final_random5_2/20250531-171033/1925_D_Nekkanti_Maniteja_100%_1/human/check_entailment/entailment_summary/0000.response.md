Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses the formula for the expected value of the sum of friendship values, which is the sum of the products of the probability of choosing each pair and the friendship value of that pair. The program also correctly calculates the probability of choosing each pair, which is the inverse of the total number of possible pairs.

The program also correctly handles the case where the total number of possible pairs is not coprime with the modulus M, by using the pow function with three arguments to calculate the modular inverse.

The program also correctly prints the result modulo M, which is the required output format.

Correctness: **True**