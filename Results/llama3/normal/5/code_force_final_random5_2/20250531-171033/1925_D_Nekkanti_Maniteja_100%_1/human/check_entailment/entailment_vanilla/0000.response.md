Reasoning:

The given program is designed to solve the problem of calculating the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a step-by-step breakdown of the program's logic:

1. The program starts by reading the number of test cases (t) and then iterates over each test case.

2. For each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

3. It calculates the modular multiplicative inverse of the total number of possible pairs (n * (n - 1) // 2) modulo M (10^9 + 7), where M is a prime number used for modular arithmetic. This inverse is stored in the variable c.

4. It initializes two variables, s and a, to zero. The variable s will store the expected value of the sum of friendship values, and the variable a will store the sum of the initial friendship values of all pairs.

5. It then reads the m pairs of friends along with their friendship values, and for each pair, it adds the friendship value to the variable a.

6. After reading all pairs, it calculates the expected value of the sum of friendship values for each excursion. This is done by iterating over each excursion (from 0 to k - 1) and adding the product of the modular multiplicative inverse (c), the current excursion number (i), the modular multiplicative inverse (c) again, and the number of pairs (m) to the variable s. It also adds the product of the modular multiplicative inverse (c) and the sum of the initial friendship values (a) to the variable s.

7. Finally, it prints the expected value of the sum of friendship values modulo M for each test case.

Based on the provided problem description and the program's logic, the program correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Correctness: **True**