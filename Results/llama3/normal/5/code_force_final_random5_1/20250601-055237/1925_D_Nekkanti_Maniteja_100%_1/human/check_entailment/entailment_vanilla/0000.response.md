Reasoning:

The given program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. Here's a step-by-step breakdown of the program's correctness:

1. The program starts by reading the number of test cases and then iterating over each test case.

2. For each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

3. It calculates the modular multiplicative inverse of the total number of possible pairs (n * (n - 1) // 2) modulo M (10^9 + 7), where M is a prime number. This is done to efficiently calculate the probability of choosing a pair of friends in each excursion.

4. It initializes two variables: s (to store the expected sum of friendship values) and a (to store the sum of initial friendship values of all pairs).

5. It then reads the initial friendship values of all pairs and adds them to the variable a.

6. The program then calculates the expected sum of friendship values for each excursion. In each excursion, the expected sum is the sum of the probabilities of choosing each pair of friends multiplied by their current friendship value. The probability of choosing a pair of friends is the modular multiplicative inverse of the total number of possible pairs (c). The current friendship value of each pair is the initial friendship value (a) plus the number of excursions that have been completed so far (i).

7. Finally, the program prints the expected sum of friendship values modulo M for each test case.

Based on the above analysis, the program correctly calculates the expected sum of friendship values for each test case.

Correctness: **True**