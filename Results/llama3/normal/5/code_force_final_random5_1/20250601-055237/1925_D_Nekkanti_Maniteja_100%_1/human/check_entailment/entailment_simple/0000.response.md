Reasoning:

The given Python program is designed to solve the problem described. Here's a breakdown of the program's correctness:

1. The program reads the number of test cases `t` and iterates over each test case.
2. For each test case, it reads the number of children `n`, the number of pairs of friends `m`, and the number of excursions `k`.
3. It calculates the modular multiplicative inverse `c` of `n*(n-1)//2` modulo `M` (where `M` is 10^9 + 7). This is used to calculate the probability of choosing a pair of friends.
4. It initializes the sum `s` to 0 and the sum of friendship values `a` to 0.
5. It reads `m` lines, each containing three integers `u`, `v`, and `f`, representing a pair of friends and their friendship value. It adds the friendship value `f` to the sum `a`.
6. It iterates `k` times, calculating the expected value of the sum of friendship values for each excursion. In each iteration, it adds the product of the probability `c`, the current excursion number `i`, the number of pairs of friends `m`, and the sum of friendship values `a` to the sum `s`.
7. Finally, it prints the value of `s` modulo `M` for each test case.

The program's logic is correct, and it accurately implements the problem's requirements. The use of modular arithmetic ensures that the program can handle large inputs without overflowing.

Correctness: **True**