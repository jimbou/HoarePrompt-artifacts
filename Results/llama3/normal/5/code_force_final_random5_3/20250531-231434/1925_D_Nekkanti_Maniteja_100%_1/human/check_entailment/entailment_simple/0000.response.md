Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a breakdown of the program's correctness:

1. The program first reads the number of test cases and then for each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

2. It calculates the modular multiplicative inverse of n * (n - 1) // 2 modulo M (10^9 + 7) and stores it in the variable c. This is used to calculate the probability of choosing a pair of friends in each excursion.

3. It initializes a variable s to 0, which will store the expected value of the sum of friendship values.

4. It then reads the m pairs of friends and their friendship values, and calculates the sum of all friendship values (a).

5. The program then calculates the expected value of the sum of friendship values for each excursion. It does this by iterating over each excursion (i) and adding the probability of choosing a pair of friends (c * i * c * m) and the probability of choosing a pair of non-friends (c * a) to the total expected value (s).

6. Finally, it prints the expected value of the sum of friendship values modulo M.

The program's logic is correct, and it correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Correctness: **True**