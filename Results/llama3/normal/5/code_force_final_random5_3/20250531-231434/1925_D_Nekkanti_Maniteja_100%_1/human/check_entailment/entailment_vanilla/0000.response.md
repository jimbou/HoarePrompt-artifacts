Reasoning:

The given program is designed to solve the problem of finding the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses the concept of modular arithmetic to handle large numbers.

Here's a step-by-step breakdown of the program's correctness:

1. The program starts by reading the number of test cases and then iterating over each test case.

2. For each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

3. It calculates the modular inverse of the total number of possible pairs (n * (n - 1) // 2) modulo M (10^9 + 7). This is done using the pow function with a negative exponent, which is a common way to calculate modular inverses in Python.

4. It initializes two variables: s (the sum of friendship values) and a (the sum of initial friendship values).

5. It then reads the initial friendship values for each pair of friends and adds them to the variable a.

6. The program then calculates the expected value of the sum of friendship values for each excursion. This is done by iterating over each excursion and adding the product of the modular inverse of the total number of possible pairs, the current excursion number, the modular inverse of the total number of possible pairs, and the number of pairs of friends to the variable s. It also adds the product of the modular inverse of the total number of possible pairs and the sum of initial friendship values to s.

7. Finally, the program prints the result modulo M.

Based on the problem description and the provided code, the program seems to be correct. It correctly calculates the expected value of the sum of friendship values for each excursion and handles large numbers using modular arithmetic.

Correctness: **True**