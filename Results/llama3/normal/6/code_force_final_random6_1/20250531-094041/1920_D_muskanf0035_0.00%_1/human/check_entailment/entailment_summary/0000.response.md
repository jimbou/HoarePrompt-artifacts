Reasoning: 
The given program is designed to solve the problem described. The main function, `func_2`, reads the input, calls `func_1` to process the operations and queries, and prints the results. `func_1` constructs the array by processing the operations and then answers the queries by returning the values at the corresponding indices.

However, there is a logical error in `func_1`. When the operation type is 2, the function duplicates the entire array, but it does not consider the case where the array size exceeds the limit of 10^18. In such cases, the function should not duplicate the array but instead, keep track of the size of the array and use it to calculate the index for the queries.

Correctness: **False**