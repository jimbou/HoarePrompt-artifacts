Reasoning:

The given program is correct. Here's why:

1. The program correctly reads the input for each test case, which consists of the number of children (n), the number of pairs of friends (m), and the number of excursions (k), followed by m lines of three integers each representing the indices of the pair of children who are friends and their friendship value.

2. The program correctly calculates the sum of all friendship values (a) by iterating over the m lines of input.

3. The program correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. This is done by iterating over the k excursions and adding the product of the modular multiplicative inverse of the total number of possible pairs (c), the current excursion number (i), and the sum of all friendship values (a) to the result (s). The modular multiplicative inverse of the total number of possible pairs is calculated using the pow function with a negative exponent, which is a common way to calculate modular multiplicative inverses in Python.

4. The program correctly prints the remainder of the result (s) divided by the modulus M (1000000007) for each test case.

5. The program correctly handles the case where there are no pairs of friends (m = 0) by initializing the sum of all friendship values (a) to 0 and not adding anything to the result (s) in this case.

6. The program correctly handles the case where the number of excursions (k) is 0 by not iterating over the excursions and not adding anything to the result (s) in this case.

7. The program correctly handles the case where the number of children (n) is 2 by correctly calculating the modular multiplicative inverse of the total number of possible pairs (c) and using it to calculate the result (s).

8. The program correctly handles the case where the number of pairs of friends (m) is equal to the total number of possible pairs (n*(n-1)/2) by correctly calculating the modular multiplicative inverse of the total number of possible pairs (c) and using it to calculate the result (s).

Correctness: **True**