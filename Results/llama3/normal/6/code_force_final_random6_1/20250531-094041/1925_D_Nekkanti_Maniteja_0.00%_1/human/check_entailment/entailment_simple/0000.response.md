Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a breakdown of the program's correctness:

1. The program first reads the number of test cases, then for each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

2. It calculates the modular multiplicative inverse of n*(n-1) modulo M (10^9+7), which is used to calculate the probability of choosing a pair of friends.

3. It initializes the sum of friendship values (s) to 0 and the sum of initial friendship values (a) to 0.

4. It then reads the m pairs of friends and their friendship values, and adds the friendship values to the sum (a).

5. It calculates the expected value of the sum of friendship values for each excursion. For each excursion, it adds the probability of choosing a pair of friends (c*m) times the current sum of friendship values (a) to the total sum (s). It also adds the probability of choosing a pair of friends (c*m) times the number of excursions (i) to the total sum (s), because the friendship value of a pair of friends increases by 1 for each excursion.

6. Finally, it prints the remainder of the total sum (s) divided by M, which is the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Correctness: **True**