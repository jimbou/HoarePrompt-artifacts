Functionality: This function reads multiple test cases from standard input, each containing an integer k, followed by k lines of three integers (n, m, k), and then m lines of three integers (a_i, b_i, f_i). It calculates the sum of all f values (a) and the modular multiplicative inverse of n*(n-1) modulo M (c). Then, it calculates the value of s as k * c * a + c * m * (k * (k-1) / 2) and prints the remainder of s divided by M. The function repeats this process for each test case until standard input is empty.