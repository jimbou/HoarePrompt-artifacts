Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a breakdown of the program's correctness:

1. The program reads the input correctly, parsing the number of test cases, and for each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k). It also reads the m lines of three integers each, representing the pairs of friends and their friendship values.

2. The program calculates the sum of all friendship values (a) correctly by iterating over the m lines of input and adding up the friendship values.

3. The program calculates the expected value of the sum of friendship values (s) correctly. It uses the formula for the expected value of a random variable, which is the sum of the product of each possible value and its probability. In this case, the possible values are the friendship values, and their probabilities are the probabilities of choosing each pair of friends, which is c = 1 / (n * (n - 1) / 2).

4. The program correctly calculates the probability c using the modular inverse of n * (n - 1) / 2 modulo M (10^9 + 7). This is necessary to avoid overflow and to ensure that the calculations are done modulo M.

5. The program correctly calculates the expected value s by iterating over the k excursions and adding up the product of the probability c, the current excursion number i, the number of pairs of friends m, and the sum of friendship values a.

6. Finally, the program correctly prints the remainder of s divided by M for each test case.

Therefore, the given program is correct.

Correctness: **True**