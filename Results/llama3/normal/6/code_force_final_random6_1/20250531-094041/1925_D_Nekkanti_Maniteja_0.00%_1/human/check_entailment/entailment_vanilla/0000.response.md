Reasoning:

The given program is designed to solve the problem of finding the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses a modular arithmetic approach to avoid overflow and ensure accurate results.

Here's a step-by-step breakdown of the program's logic:

1. The program starts by reading the number of test cases (t) and iterating over each test case.
2. For each test case, it reads the number of children (n), pairs of friends (m), and excursions (k).
3. It calculates the modular multiplicative inverse of `n * (n - 1) // 2` modulo `10^9 + 7` and stores it in the variable `c`. This value represents the probability of choosing a pair of friends in a single excursion.
4. It initializes two variables: `s` to store the expected value of the sum of friendship values, and `a` to store the sum of the initial friendship values of all pairs.
5. It reads the `m` pairs of friends and their corresponding friendship values, adding each value to `a`.
6. It iterates over the `k` excursions, updating the expected value `s` at each step. The update formula is `s = s + c * i * c * m + c * a`, where `i` is the current excursion number.
7. Finally, it prints the expected value `s` modulo `10^9 + 7` for each test case.

The program's logic is correct, and it accurately implements the problem's requirements. The use of modular arithmetic ensures that the results are accurate and efficient.

Correctness: **True**