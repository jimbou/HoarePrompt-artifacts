Reasoning:

The given program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses the concept of modular arithmetic to avoid overflow and ensure the result is within the range of 10^9+7.

Here's a step-by-step breakdown of the program's correctness:

1. The program reads the number of test cases and iterates over each test case.
2. For each test case, it reads the number of children (n), pairs of friends (m), and excursions (k).
3. It calculates the modular inverse of n*(n-1)//2 (the total number of possible pairs) modulo 10^9+7, which is stored in the variable c. This is used to calculate the probability of choosing a pair of friends.
4. It initializes two variables: s (the sum of friendship values) and a (the sum of initial friendship values).
5. It reads the m pairs of friends and their friendship values, adding the friendship values to the variable a.
6. It calculates the expected value of the sum of friendship values for each excursion using the formula: s = s + c * i * c * m + c * a. This formula takes into account the probability of choosing a pair of friends, the number of excursions, and the initial friendship values.
7. Finally, it prints the result modulo 10^9+7.

The program's logic and calculations appear to be correct. It properly handles the modular arithmetic and calculates the expected value of the sum of friendship values for each excursion.

Correctness: **True**