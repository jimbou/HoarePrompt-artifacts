Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a breakdown of the program's logic:

1. It first reads the number of test cases, and for each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

2. It calculates the modular multiplicative inverse of n * (n - 1) modulo M (10^9 + 7), which is the probability of choosing a pair of friends in each excursion.

3. It initializes the sum of friendship values (s) to 0 and the sum of initial friendship values (a) to 0.

4. It then reads the m pairs of friends and their friendship values, and adds the friendship values to the sum (a).

5. It calculates the expected value of the sum of friendship values for each excursion. In each excursion, the probability of choosing a pair of friends is c (the modular multiplicative inverse of n * (n - 1) modulo M), and the expected value of the sum of friendship values is c * i * c * m + c * a, where i is the current excursion number.

6. It adds the expected value of the sum of friendship values for each excursion to the total sum (s).

7. Finally, it prints the total sum (s) modulo M.

The program's logic is correct, and it should produce the expected output for the given input.

Correctness: **True**