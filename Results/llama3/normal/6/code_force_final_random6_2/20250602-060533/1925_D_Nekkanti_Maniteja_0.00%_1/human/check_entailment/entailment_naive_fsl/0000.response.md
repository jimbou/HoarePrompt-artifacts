Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the probability of choosing a pair of friends in each excursion.

In the program, the probability of choosing a pair of friends is calculated as `c * m`, where `c` is the modular multiplicative inverse of `n * (n - 1) // 2` modulo `M`, and `m` is the number of pairs of friends. However, this calculation is incorrect because it does not take into account the fact that the probability of choosing a pair of friends changes after each excursion.

A correct approach would be to calculate the probability of choosing a pair of friends in each excursion as `c * (m + i)`, where `i` is the current excursion number. This is because the number of pairs of friends increases by 1 after each excursion, and the probability of choosing a pair of friends should reflect this change.

Here is an example of a case where the program does not work correctly:

Input:

```
1
3 2 2
1 2 1
2 3 1
```

Output:

```
1
```

Expected Output:

```
2
```

In this example, the program calculates the expected value of the sum of friendship values as 1, but the correct expected value is 2. This is because the probability of choosing a pair of friends in the second excursion is `c * 3`, not `c * 2`, since the number of pairs of friends has increased by 1 after the first excursion.