Reasoning:

The given Python program is designed to solve the problem described. Here's a step-by-step breakdown of the program's correctness:

1. The program starts by reading the number of test cases `t` and then iterates over each test case.

2. For each test case, it reads the number of children `n`, the number of pairs of friends `m`, and the number of excursions `k`.

3. It calculates the modular multiplicative inverse of `n * (n - 1) // 2` modulo `M` (where `M = 10^9 + 7`) and stores it in `c`. This is used to calculate the probability of choosing a pair of friends.

4. It initializes two variables `s` and `a` to 0. `s` will store the expected value of the sum of friendship values, and `a` will store the sum of the initial friendship values.

5. It then reads `m` lines, each containing the indices of a pair of friends and their friendship value. For each pair, it adds the friendship value to `a`.

6. After reading all pairs, it calculates the expected value of the sum of friendship values for each excursion. This is done by iterating `k` times and adding the product of the probability of choosing a pair of friends (`c * m`), the current excursion number (`i`), and the probability of choosing a pair of friends again (`c`) to `s`. It also adds the product of the probability of choosing a pair of friends (`c`) and the sum of the initial friendship values (`a`) to `s`.

7. Finally, it prints the expected value of the sum of friendship values modulo `M` for each test case.

Based on the problem description and the provided program, the program correctly calculates the expected value of the sum of friendship values for each test case.

Correctness: **True**