Reasoning:

The given program is correct. It correctly implements the interactive problem's requirements and logic. Here's a breakdown of the reasoning:

1. The program reads the number of test cases and iterates over each test case.
2. For each test case, it reads the value of `n` and initializes `mak` to 0.
3. The program then iterates over the range from 1 to `n` and queries the input to find the maximum value in the permutation. It updates `mak` accordingly.
4. After finding the maximum value, the program iterates over the range from 0 to `n` and queries the input to find all indices `i` such that the input string is '=' at iteration `i`. It stores these indices in the `pans` list.
5. The program then iterates over the `pans` list and queries the input to find the index of the maximum value in the list. It updates `mak` accordingly.
6. Finally, the program outputs the index of the maximum value and the value itself in the format '! <index> <value>'.
7. The program flushes the output buffer after each query and after the final output to ensure that the output is displayed correctly.

The program's logic is correct, and it follows the problem's requirements. It uses at most 3n queries, as required, and produces the correct output format.

Correctness: **True**