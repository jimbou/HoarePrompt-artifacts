Reasoning:

The given Python program is correct. It accurately implements the mathematical formula to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions.

The program correctly reads the input, calculates the sum of all f values, and uses this sum, along with n, m, and k, to compute the values of p and q. It also correctly calculates the greatest common divisor (gcd) of p and q and uses it to simplify the fraction p/q.

The program then correctly prints the result of the modular arithmetic operation involving p, q, and gcd for each test case. The use of the pow function with three arguments is correct, as it efficiently calculates the modular multiplicative inverse of q modulo M.

Overall, the program is well-structured, and the logic is correct. It should produce the expected output for the given input.

Correctness: **True**