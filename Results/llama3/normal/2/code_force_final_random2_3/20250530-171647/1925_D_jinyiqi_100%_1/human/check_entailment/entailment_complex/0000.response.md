Reasoning:

The given program is correct. Here's why:

1. The program correctly reads the input for each test case, which consists of three integers n, m, and k, followed by m lines of three integers a_i, b_i, and f_i.

2. It calculates the sum of all f_i values, which is used later in the calculation of p.

3. The program then calculates the values of p and q based on the formulas provided in the problem description. The formulas are correctly implemented, and the values of p and q are correctly calculated.

4. The program then calculates the greatest common divisor (gcd) of p and q, and divides both p and q by the gcd. This is done to ensure that p and q are coprime, as required by the problem.

5. Finally, the program calculates the modular multiplicative inverse of q modulo M (where M is 10^9 + 7), multiplies it by p, and prints the result. This is the expected output of the program.

Overall, the program correctly implements the required calculations and produces the expected output for each test case.

Correctness: **True**