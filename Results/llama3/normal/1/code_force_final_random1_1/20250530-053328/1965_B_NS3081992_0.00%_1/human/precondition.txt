d is an integer, processing is a boolean, da is a list of integers, rank is a list of integers.