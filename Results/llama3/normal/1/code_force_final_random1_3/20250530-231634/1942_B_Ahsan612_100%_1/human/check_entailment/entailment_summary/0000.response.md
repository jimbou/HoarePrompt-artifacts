Reasoning:

The given program is correct. It correctly implements the logic to construct a valid permutation `p` based on the given array `a`. The program uses a deque to efficiently update the `mex` value and construct the permutation in reverse order.

The program first reads the number of test cases and then for each test case, it reads the length of the permutation `n` and the array `a`. It then initializes an array `res` of size `n` to store the permutation and sets the initial `mex` value to `n`.

The program then iterates over the array `a` in reverse order. For each element `a_i`, it calculates the corresponding element `p_i` in the permutation as `mex - a_i` and updates the `mex` value to be the minimum of its current value and `mex - a_i`. This ensures that the `mex` value is always the minimum non-negative integer that does not appear in the permutation constructed so far.

Finally, the program prints the constructed permutation as a string of space-separated values.

The execution summary correctly describes the behavior of the program, and the program correctly implements the logic to construct a valid permutation `p` based on the given array `a`.

Correctness: **True**