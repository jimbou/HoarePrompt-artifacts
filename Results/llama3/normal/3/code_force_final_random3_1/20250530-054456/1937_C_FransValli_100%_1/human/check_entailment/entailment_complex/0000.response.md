Reasoning:

The given program is correct. It correctly implements the required logic to find the maximum and minimum elements in the permutation by querying the input stream. The program uses a binary search-like approach to find the maximum element, and then uses a similar approach to find the minimum element among the remaining elements.

The program also correctly handles the input and output operations, using the `flush=True` argument to ensure that the output is immediately flushed to the output stream.

The program's logic is sound, and it should correctly find the maximum and minimum elements in the permutation for each test case. The program also adheres to the constraints specified in the problem statement, including the limit on the number of queries.

Correctness: **True**