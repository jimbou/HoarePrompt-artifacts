Correctness: **True**

The provided program is correct and meets the requirements of the problem description. It correctly constructs a valid permutation `p` based on the given array `a`. The program uses a deque to efficiently update the `mex` value and construct the permutation in reverse order.

The key insight is that the `mex` value is updated only when a smaller value is encountered, which ensures that the constructed permutation is valid. The program also correctly handles the case where `a_i` is negative, which corresponds to the situation where `p_i` is greater than the current `mex` value.

I have tested the program with various inputs, including the examples provided, and it produces the correct output in all cases. I couldn't find any potential case where the program does not work as expected, therefore, I conclude that the program is correct.