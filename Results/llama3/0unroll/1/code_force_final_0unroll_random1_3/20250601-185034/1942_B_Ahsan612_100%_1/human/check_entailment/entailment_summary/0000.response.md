Reasoning:
The given program is correct. It correctly implements the logic to construct a valid permutation p that satisfies the given array a. The program uses a deque to efficiently calculate the minimum non-negative integer that does not appear in the array (MEX) and constructs the permutation p in reverse order.

The program first reads the number of test cases and then for each test case, it reads the length of the permutation (n) and the array a. It initializes an array res of size n to store the permutation p and a variable mex to keep track of the current MEX.

The program then iterates over the array a in reverse order. For each element a_i, it calculates the corresponding element p_i in the permutation p as mex - a_i and updates mex to be the minimum of mex and p_i. This ensures that the MEX of the permutation p is correctly calculated.

Finally, the program prints the permutation p for each test case.

Correctness: **True**