Reasoning:

The given program is correct. Here's why:

1. The program correctly reads the input for each test case, which consists of the number of children (n), the number of pairs of friends (m), and the number of excursions (k). It also reads the friendship values for each pair of friends.

2. The program calculates the sum of the initial friendship values (sum_f) and the total number of possible pairs of children (cn2).

3. The program calculates the numerator (p) and denominator (q) of the expected value of the sum of friendship values. The numerator is calculated as 2 * k * cn2 * sum_f + m * k * (k - 1), which represents the total increase in friendship values over all excursions. The denominator is calculated as 2 * cn2 ** 2, which represents the total number of possible pairs of children squared.

4. The program calculates the greatest common divisor (gcd) of p and q using the math.gcd function, and then divides both p and q by the gcd to simplify the fraction.

5. The program calculates the modular inverse of q modulo M (10^9 + 7) using the pow function with a negative exponent, and then multiplies p by this modular inverse to get the final result.

6. The program prints the final result for each test case.

The program correctly implements the mathematical formula for the expected value of the sum of friendship values, and it correctly handles the modular arithmetic to avoid overflow.

Correctness: **True**