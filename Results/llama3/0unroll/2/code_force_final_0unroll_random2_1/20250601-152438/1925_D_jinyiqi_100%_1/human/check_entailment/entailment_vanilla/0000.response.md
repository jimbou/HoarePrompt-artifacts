Reasoning:

The given program is designed to solve the problem of calculating the expected value of the sum of friendship values of all k pairs chosen for the excursions. Here's a step-by-step analysis of the program's correctness:

1. The program starts by reading the number of test cases `t` and defining the modulus `M` as `10^9 + 7`.

2. For each test case, it reads the number of children `n`, the number of pairs of friends `m`, and the number of excursions `k`.

3. It then calculates the sum of the initial friendship values `sum_f` by iterating over the `m` pairs of friends and adding their friendship values.

4. The program calculates the total number of possible pairs `cn2` using the formula `n * (n - 1) // 2`.

5. It then calculates the numerator `p` and denominator `q` of the expected value. The numerator `p` is calculated as `2 * k * cn2 * sum_f + m * k * (k - 1)`, which represents the sum of the products of the number of excursions, the total number of possible pairs, and the sum of the initial friendship values, plus the sum of the products of the number of pairs of friends, the number of excursions, and the number of excursions minus one. The denominator `q` is calculated as `2 * cn2 ** 2`, which represents twice the square of the total number of possible pairs.

6. The program then calculates the greatest common divisor `gcd` of `p` and `q` using the `math.gcd` function and divides both `p` and `q` by `gcd` to simplify the fraction.

7. Finally, the program calculates the modular multiplicative inverse of `q` modulo `M` using the `pow` function with three arguments and prints the result of the multiplication of `p` and the modular multiplicative inverse of `q` modulo `M`.

Based on the above analysis, the program correctly implements the formula for the expected value of the sum of friendship values of all k pairs chosen for the excursions and performs the necessary calculations to obtain the result modulo `10^9 + 7`.

Correctness: **True**