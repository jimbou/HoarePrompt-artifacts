Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the probability `p` and `q`.

The correct calculation of `p` should be `2 * k * cn2 * sum_f + m * k * (k - 1) * (n * (n - 1) // 2 - m)`, not `2 * k * cn2 * sum_f + m * k * (k - 1)`. This is because the probability of choosing a pair of friends is not just `m / cn2`, but also depends on the number of non-friend pairs.

Similarly, the correct calculation of `q` should be `2 * cn2 ** 2 * k`, not `2 * cn2 ** 2`. This is because the denominator should be the total number of possible pairs, which is `cn2 * k`.

Therefore, the program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions, and the correctness is **False**.