Reasoning:

The given Python program is correct based on the problem description and the execution states of the program provided as comments. Here's why:

1.  The program correctly reads the input for each test case, which consists of three integers `n`, `m`, and `k`, followed by `m` lines of three integers `a_i`, `b_i`, and `f_i`.
2.  It calculates the sum of `f_i` values for each test case, which is used in the subsequent calculations.
3.  The program computes the total number of possible pairs of children (`cn2`) and uses it to calculate the expected value of the sum of friendship values for all `k` pairs chosen for the excursions.
4.  It correctly calculates the modular inverse of the denominator (`q`) using the `pow` function with a modulus of `M` (`10^9 + 7`).
5.  The program prints the result of the modular inverse calculation for each test case, which is the expected value of the sum of friendship values for all `k` pairs chosen for the excursions.

The program's logic and calculations align with the problem description, and it correctly handles the input and output for each test case.

Correctness: **True**