Reasoning: 

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program first calculates the sum of the initial friendship values for each test case. Then, it calculates the probability of choosing a pair of friends in each excursion, which is 2 / (n * (n - 1)). The program then calculates the expected increase in the sum of friendship values for each excursion, which is the sum of the initial friendship values plus the number of pairs of friends times the number of excursions minus one. Finally, the program calculates the modular inverse of the denominator of the expected value and prints the result.

The program uses the math.gcd function to calculate the greatest common divisor of the numerator and denominator of the expected value, which is used to simplify the fraction. The program also uses the pow function with three arguments to calculate the modular inverse of the denominator, which is more efficient than calculating the modular inverse using the pow function with two arguments.

The execution summary shows that the program consumes all input from standard input and produces output for each test case, which is consistent with the problem description.

Correctness: **True**