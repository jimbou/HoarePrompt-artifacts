Reasoning:

The given program is correct. It correctly counts the occurrences of the substrings 'map' and 'pie' in each string and prints their sum for each test case. The program also handles the case where the string is already beautiful by printing 0.

The program's approach of replacing 'map' with an empty string before counting 'pie' is also correct, as it ensures that 'pie' is not counted as part of a 'map' substring.

The program's time complexity is O(n), where n is the length of the string, which is acceptable given the constraints of the problem.

The program's output matches the expected output for the provided example inputs.

Correctness: **True**