Correctness: **True**

The program correctly implements the logic to construct a valid permutation `p` based on the given array `a`. The key insight is to start from the end of the array and work backwards, using the fact that `a_i = MEX(p_1, p_2, ..., p_i) - p_i`.

The program initializes an array `p` of size `n` with all elements set to `-1`, and a variable `mex` to `n`. Then, it iterates over the array `a` in reverse order, and for each element `a_i`, it calculates the corresponding element `p_i` as `mex - a_i`. It then updates `mex` to be the minimum of its current value and `p_i`.

This approach ensures that the constructed permutation `p` satisfies the condition `a_i = MEX(p_1, p_2, ..., p_i) - p_i` for all `i`. The program also correctly handles the case where `a_i` is negative, by using the fact that `MEX` is always non-negative.

I couldn't find any potential case where the program does not work correctly, and all the examples provided in the problem description work as expected. Therefore, I conclude that the program is correct.