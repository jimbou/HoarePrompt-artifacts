Reasoning:

The given Python program is designed to solve a problem involving the expected value of the sum of friendship values of all k pairs chosen for excursions. The program processes multiple test cases from standard input, where each test case contains an integer t, followed by 3 integers n, m, and k, and then m lines of three integers each.

The program calculates the sum of the products of the modular inverses of the number of pairs of nodes, the number of edges, and the sum of the frequencies of the edges, all taken modulo 10^9 + 7. This calculation is based on the formula for the expected value of the sum of friendship values, which involves the probability of choosing a pair of friends, the initial friendship value, and the increase in friendship value for each subsequent excursion.

The program uses the pow function to calculate the modular inverse of the number of pairs of nodes, which is necessary to avoid division by zero and to ensure that the result is an integer. The program also uses the modulo operator to ensure that the final result is within the range of 0 to 10^9 + 6.

The program's logic is correct, and it accurately implements the formula for the expected value of the sum of friendship values. The program also handles the input and output correctly, reading the test cases from standard input and printing the results for each test case.

Therefore, based on the problem description and the execution states of the program provided as comments, the given Python program is correct.

Correctness: **True**