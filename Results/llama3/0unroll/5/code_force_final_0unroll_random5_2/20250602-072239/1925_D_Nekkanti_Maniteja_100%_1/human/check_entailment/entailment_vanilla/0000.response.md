Reasoning:

The given program is designed to solve the problem described. Here's a step-by-step breakdown of the program's correctness:

1. The program first reads the number of test cases `t` and then iterates over each test case.

2. For each test case, it reads the number of children `n`, the number of pairs of friends `m`, and the number of excursions `k`.

3. It calculates the modular multiplicative inverse of `n * (n - 1) // 2` modulo `M` (where `M = 10 ** 9 + 7`) and stores it in `c`. This is used to calculate the probability of choosing a pair of friends.

4. It initializes `s` to 0, which will store the expected value of the sum of friendship values, and `a` to 0, which will store the sum of the initial friendship values.

5. It then reads `m` lines, each containing the indices of a pair of friends and their friendship value. It adds the friendship value to `a`.

6. It calculates the expected value of the sum of friendship values for each excursion. For each excursion `i`, it adds the probability of choosing a pair of friends (`c * i * c * m`) and the expected value of the friendship value (`c * a`) to `s`.

7. Finally, it prints the expected value of the sum of friendship values modulo `M`.

The program correctly implements the problem's requirements and uses the correct formulas to calculate the expected value of the sum of friendship values.

Correctness: **True**