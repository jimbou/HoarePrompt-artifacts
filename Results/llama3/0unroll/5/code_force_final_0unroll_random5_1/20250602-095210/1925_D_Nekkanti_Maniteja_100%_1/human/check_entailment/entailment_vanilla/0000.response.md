Reasoning:

The given program is designed to solve the problem described. Here's a step-by-step breakdown of the program's correctness:

1. The program starts by reading the number of test cases `t` and then iterates over each test case.

2. For each test case, it reads the number of children `n`, the number of pairs of friends `m`, and the number of excursions `k`.

3. It calculates the modular multiplicative inverse of `n * (n - 1) // 2` modulo `M` (where `M = 10 ** 9 + 7`) and stores it in `c`. This is used to calculate the probability of choosing a pair of friends.

4. It initializes two variables `s` and `a` to 0. `s` is used to store the expected value of the sum of friendship values, and `a` is used to store the sum of the initial friendship values.

5. It then reads `m` lines, each containing three integers `u`, `v`, and `f`, which represent the indices of a pair of friends and their friendship value. It adds `f` to `a` for each pair.

6. After reading all pairs, it calculates the expected value of the sum of friendship values for each excursion. For each excursion `i`, it adds `c * i * c * m + c * a` to `s`. This is based on the formula for the expected value of the sum of friendship values, which is the sum of the probabilities of choosing each pair of friends multiplied by their friendship value.

7. Finally, it prints the result `s % M` for each test case.

The program correctly implements the formula for the expected value of the sum of friendship values and uses modular arithmetic to avoid overflow. Therefore, the program is correct.

Correctness: **True**