Reasoning:

The given program is correct. Here's why:

1. The program correctly reads the input for each test case, which consists of an integer n, an integer m, an integer k, and m lines of input containing three integers a, b, and f.

2. The program calculates the modular multiplicative inverse of the number of pairs of nodes in the graph, which is n * (n - 1) // 2. This is done using the pow function with a modulus of 10^9 + 7.

3. The program initializes two variables, s and a, to 0. The variable s will store the sum of the products of the modular multiplicative inverse of the number of pairs of nodes in the graph, the number of edges, and the sum of the frequencies of the edges, taken modulo 10^9 + 7. The variable a will store the sum of the frequencies of the edges.

4. The program then reads the m lines of input for each test case, where each line contains three integers a, b, and f. It adds the frequency f to the variable a.

5. The program then calculates the sum of the products of the modular multiplicative inverse of the number of pairs of nodes in the graph, the number of edges, and the sum of the frequencies of the edges, taken modulo 10^9 + 7, for each test case. This is done using a loop that runs k times, where k is the number of excursions.

6. In each iteration of the loop, the program calculates the product of the modular multiplicative inverse of the number of pairs of nodes in the graph, the number of edges, and the sum of the frequencies of the edges, taken modulo 10^9 + 7. It adds this product to the variable s.

7. After the loop finishes, the program prints the value of s modulo 10^9 + 7 for each test case.

The program correctly implements the formula for the expected value of the sum of friendship values of all k pairs chosen for the excursions, which is the sum of the products of the modular multiplicative inverse of the number of pairs of nodes in the graph, the number of edges, and the sum of the frequencies of the edges, taken modulo 10^9 + 7.

Correctness: **True**