Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the sum `s`. The program multiplies `c` (the probability of choosing a pair of friends) by `i` (the current excursion number), `c` again, and `m` (the number of pairs of friends), and adds this to `c` times `a` (the sum of the initial friendship values). This is incorrect because it does not take into account the fact that the friendship value of a pair increases by 1 for each excursion they are chosen.

A correct approach would be to calculate the expected increase in friendship value for each pair of friends for each excursion, and then sum these increases over all excursions. This can be done by multiplying the probability of choosing a pair of friends (`c`) by the number of excursions (`k`) and the initial friendship value (`f`), and then summing these products over all pairs of friends.

Here is a corrected version of the program:
```
def func():
    for i in range(int(input())):
        (n, m, k) = map(int, input().split())
        M = 10 ** 9 + 7
        c = pow(n * (n - 1) // 2, -1, M)
        s = 0
        for i in range(m):
            (u, v, f) = map(int, input().split())
            s += f * k * c
        print(s % M)
```
This program correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.