Reasoning:

The given program is correct. It correctly implements the required calculation for each test case, taking into account the number of children, pairs of friends, and excursions. The program uses modular arithmetic with a large modulus (10^9 + 7) to avoid overflow and ensure accurate results.

The program first reads the number of test cases, then for each test case, it reads the number of children (n), pairs of friends (m), and excursions (k). It then reads the m lines of three integers each, representing the pairs of friends and their friendship values.

The program calculates the inverse of the number of pairs of nodes in a graph (n * (n - 1) // 2) modulo the large modulus (M), which is used to calculate the expected value of the sum of friendship values.

The program then calculates the sum of products of the inverse, the number of edges (m), and the sum of edge weights (a), taken modulo the large modulus (M). This calculation is performed for each excursion (k).

Finally, the program prints the result for each test case, one per line.

Correctness: **True**