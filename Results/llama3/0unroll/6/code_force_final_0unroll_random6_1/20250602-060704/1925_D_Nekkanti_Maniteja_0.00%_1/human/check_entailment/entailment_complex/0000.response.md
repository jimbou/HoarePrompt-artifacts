Reasoning:

The given Python program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses modular arithmetic with a large modulus (10^9 + 7) to avoid overflow.

The program first reads the number of test cases, then for each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k). It also reads the friendship values for each pair of friends.

The program then calculates the inverse of the number of pairs of nodes in a graph (c) using the pow function with a modulus of M (10^9 + 7). This is done to avoid division by zero and to ensure that the result is within the range of the modulus.

The program then initializes two variables, s and a, to zero. The variable s is used to store the sum of the products of the inverse of the number of pairs of nodes, the number of edges, and the sum of edge weights, all taken modulo the large modulus. The variable a is used to store the sum of the friendship values.

The program then iterates over the range of k (the number of excursions) and calculates the sum of the products of the inverse of the number of pairs of nodes, the number of edges, and the sum of edge weights, all taken modulo the large modulus. This is done using the formula s = s + c * i * c * m + c * a, where i is the current excursion number.

Finally, the program prints the result for each test case, which is the sum of the products of the inverse of the number of pairs of nodes, the number of edges, and the sum of edge weights, all taken modulo the large modulus.

Correctness: **True**

The program is correct because it accurately implements the formula for calculating the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses modular arithmetic with a large modulus to avoid overflow and ensures that the result is within the range of the modulus. The program also correctly initializes and updates the variables s and a, and prints the result for each test case.