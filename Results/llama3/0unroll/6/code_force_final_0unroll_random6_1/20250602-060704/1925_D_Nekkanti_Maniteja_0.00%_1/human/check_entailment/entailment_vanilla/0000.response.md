Reasoning:

The given Python program is designed to solve the problem of calculating the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a step-by-step breakdown of the program's logic:

1. The program starts by reading the number of test cases (t) and then iterates over each test case.

2. For each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k).

3. It calculates the modular multiplicative inverse of the total number of possible pairs (n * (n - 1) // 2) modulo M (10^9 + 7), where M is a prime number. This inverse is stored in the variable c.

4. It initializes two variables, s and a, to zero. The variable s will store the expected value of the sum of friendship values, and the variable a will store the sum of the initial friendship values of all pairs.

5. It then reads the initial friendship values of all pairs and adds them to the variable a.

6. The program then calculates the expected value of the sum of friendship values for each excursion. For each excursion, it adds the product of the modular multiplicative inverse (c), the current excursion number (i), the modular multiplicative inverse (c) again, and the number of pairs (m) to the variable s. This represents the expected increase in the sum of friendship values due to the current excursion. It also adds the product of the modular multiplicative inverse (c) and the current sum of friendship values (a) to the variable s. This represents the expected contribution of the current friendship values to the sum.

7. Finally, the program prints the expected value of the sum of friendship values modulo M for each test case.

Correctness: **True**