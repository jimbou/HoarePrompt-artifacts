Reasoning:

The given program is correct. It correctly implements the required logic to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a breakdown of the program's correctness:

1.  The program reads the input correctly, parsing the number of test cases, and for each test case, it reads the number of children (n), the number of pairs of friends (m), and the number of excursions (k). It also reads the m lines of three integers each, representing the indices of the pair of children who are friends and their friendship value.

2.  The program calculates the inverse of the number of possible edges in a graph (n \* (n - 1) // 2) modulo M (10^9 + 7) using the pow function with a negative exponent, which is a correct way to calculate the modular inverse.

3.  The program initializes two variables, s and a, to zero. The variable s will store the final result, and the variable a will store the sum of the friendship values of all pairs of friends.

4.  The program then iterates over the m lines of input, adding the friendship value of each pair to the variable a.

5.  After that, the program iterates k times, calculating the expected value of the sum of friendship values for each excursion. In each iteration, it adds the product of the inverse of the number of possible edges, the current excursion number, the inverse of the number of possible edges again, and the number of pairs of friends to the variable s. It also adds the product of the inverse of the number of possible edges and the sum of the friendship values to the variable s.

6.  Finally, the program prints the result of each test case, which is the value of s modulo M.

Correctness: **True**