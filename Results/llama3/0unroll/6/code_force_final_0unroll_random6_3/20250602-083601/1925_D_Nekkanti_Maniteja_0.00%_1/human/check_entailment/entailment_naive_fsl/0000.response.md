Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the probability of choosing a pair of friends in each excursion.

In the given program, the probability of choosing a pair of friends is calculated as `c * m`, where `c` is the modular multiplicative inverse of `n * (n - 1) // 2` and `m` is the number of pairs of friends. However, this calculation is incorrect because it does not take into account the fact that the probability of choosing a pair of friends changes after each excursion.

A correct approach would be to calculate the probability of choosing a pair of friends in each excursion separately, taking into account the updated friendship values after each excursion. This would require a more complex calculation, possibly involving a loop or recursion to update the probabilities after each excursion.

For example, consider the case where `n = 3`, `m = 2`, `k = 2`, and the friendship values are `f1 = 1` and `f2 = 2`. The program would calculate the probability of choosing a pair of friends in the first excursion as `c * m`, but this is incorrect because the probability of choosing the pair with friendship value `f1` is different from the probability of choosing the pair with friendship value `f2`. After the first excursion, the friendship values would be updated, and the probabilities would change again. The program does not account for these changes, leading to an incorrect calculation of the expected value.