Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the probability of choosing a pair of friends. The program uses the formula `c = pow(n * (n - 1) // 1, -1, M)` to calculate the probability, but this formula is incorrect.

The correct formula for the probability of choosing a pair of friends is `c = 2 / (n * (n - 1))`, because there are `n * (n - 1) / 2` possible pairs of children, and each pair has a `1 / (n * (n - 1) / 2)` chance of being chosen.

Additionally, the program does not correctly calculate the expected value of the sum of friendship values. The program uses the formula `s = s + c * i * c * m + c * a`, but this formula is also incorrect.

The correct formula for the expected value of the sum of friendship values is `s = sum(f_i * (1 + i * c) for i in range(k))`, where `f_i` is the friendship value of the `i-th` pair of friends.

Therefore, the program is incorrect, and it does not produce the correct output for all possible inputs.