Reasoning:

The given program is designed to solve the problem described. Here's a step-by-step breakdown of the program's correctness:

1. The program starts by reading the number of test cases `t` and then iterates over each test case.

2. For each test case, it reads the number of children `n`, the number of pairs of friends `m`, and the number of excursions `k`.

3. It calculates the modular multiplicative inverse of `n * (n - 1) // 2` modulo `M` (where `M` is `10^9 + 7`) and stores it in `c`. This is done using the `pow` function with a negative exponent, which is a common way to calculate modular multiplicative inverses in Python.

4. It initializes two variables `s` and `a` to zero. `s` will store the expected value of the sum of friendship values, and `a` will store the sum of the initial friendship values.

5. It then reads `m` lines, each containing three integers `u`, `v`, and `f`, which represent the indices of a pair of friends and their friendship value. It adds `f` to `a` for each pair.

6. After reading all pairs, it calculates the expected value of the sum of friendship values for each excursion. This is done by iterating over `k` excursions and adding the product of `c`, `i`, `c`, and `m` to `s`, where `i` is the current excursion number. It also adds the product of `c` and `a` to `s`.

7. Finally, it prints the result modulo `M` for each test case.

The program's logic is correct, and it follows the problem description accurately. It calculates the expected value of the sum of friendship values for each excursion and prints the result modulo `M` for each test case.

Correctness: **True**