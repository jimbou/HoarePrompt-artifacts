Correctness: **False**.

The program does not work correctly when the input array contains zeros. In this case, the program will attempt to divide by zero when calculating the modular inverse, which will result in a ZeroDivisionError.

For example, if the input is:

4 6
3 0 4 2
LRRL

The program will attempt to calculate the modular inverse of 0, which is undefined. Therefore, the program is incorrect.

Note that the problem description does not explicitly state that the input array cannot contain zeros, so this is a valid edge case that the program should handle.