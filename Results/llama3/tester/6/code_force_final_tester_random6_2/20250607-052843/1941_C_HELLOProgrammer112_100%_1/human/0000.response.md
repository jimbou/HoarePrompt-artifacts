# Test 1
**Input**: 
```
1
9
mmapnapie
```
**Output**: 
```
2
```
**Explanation**: This test case checks the basic functionality of the function. The input string "mmapnapie" contains both "map" and "pie" substrings, so the function should return 2, indicating that 2 characters need to be removed to make the string beautiful.

# Test 2
**Input**: 
```
1
9
azabazapi
```
**Output**: 
```
0
```
**Explanation**: This test case checks the scenario where the input string does not contain any "map" or "pie" substrings. The function should return 0, indicating that the string is already beautiful.

# Test 3
**Input**: 
```
1
8
mappppie
```
**Output**: 
```
2
```
**Explanation**: This test case checks the scenario where the input string contains multiple "map" and "pie" substrings. The function should return 2, indicating that 2 characters need to be removed to make the string beautiful.

# Test 4
**Input**: 
```
1
18
mapmapmapmapmapmap
```
**Output**: 
```
6
```
**Explanation**: This test case checks the scenario where the input string contains multiple "map" substrings. The function should return 6, indicating that 6 characters need to be removed to make the string beautiful.

# Test 5
**Input**: 
```
1
1
p
```
**Output**: 
```
0
```
**Explanation**: This test case checks the scenario where the input string is a single character. The function should return 0, indicating that the string is already beautiful.

# Test 6
**Input**: 
```
1
11
pppiepieeee
```
**Output**: 
```
2
```
**Explanation**: This test case checks the scenario where the input string contains multiple "pie" substrings. The function should return 2, indicating that 2 characters need to be removed to make the string beautiful.

# Test 7
**Input**: 
```
1
0
```
**Output**: 
```
0
```
**Explanation**: This test case checks the scenario where the input string is empty. The function should return 0, indicating that the string is already beautiful.

# Test 8
**Input**: 
```
1
1000000
abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz...
```
**Output**: 
```
0
```
**Explanation**: This test case checks the scenario where the input string is very long (1 million characters). The function should return 0, indicating that the string is already beautiful.

# Test 9
**Input**: 
```
1
1000000
mapmapmapmapmapmap...
```
**Output**: 
```
500000
```
**Explanation**: This test case checks the scenario where the input string is very long (1 million characters) and contains many "map" substrings. The function should return 500000, indicating that 500000 characters need to be removed to make the string beautiful.

# Test 10
**Input**: 
```
1
1000000
piepiepiepiepiepie...
```
**Output**: 
```
500000
```
**Explanation**: This test case checks the scenario where the input string is very long (1 million characters) and contains many "pie" substrings. The function should return 500000, indicating that 500000 characters need to be removed to make the string beautiful.