# Test 1
**Input**:
```
1
9
mmapnapie
```
**Output**:
```
2
```
**Explanation**: This test case checks the basic functionality of the function. The input string contains both "map" and "pie" substrings, and the function should return 2, indicating that 2 characters need to be removed to make the string beautiful.

# Test 2
**Input**:
```
1
9
azabazapi
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly identifies a beautiful string. The input string does not contain "map" or "pie" substrings, and the function should return 0.

# Test 3
**Input**:
```
1
8
mappppie
```
**Output**:
```
2
```
**Explanation**: This test case checks if the function correctly handles overlapping substrings. The input string contains both "map" and "pie" substrings, and the function should return 2, indicating that 2 characters need to be removed to make the string beautiful.

# Test 4
**Input**:
```
1
18
mapmapmapmapmapmap
```
**Output**:
```
6
```
**Explanation**: This test case checks if the function correctly handles multiple occurrences of the same substring. The input string contains multiple "map" substrings, and the function should return 6, indicating that 6 characters need to be removed to make the string beautiful.

# Test 5
**Input**:
```
1
1
p
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly handles a single-character input string. The input string does not contain "map" or "pie" substrings, and the function should return 0.

# Test 6
**Input**:
```
1
11
pppiepieeee
```
**Output**:
```
2
```
**Explanation**: This test case checks if the function correctly handles a string with multiple occurrences of the same substring and other characters. The input string contains multiple "pie" substrings, and the function should return 2, indicating that 2 characters need to be removed to make the string beautiful.

# Test 7
**Input**:
```
1
0
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly handles an empty input string. The function should return 0.

# Test 8
**Input**:
```
1
1000000
a...a (1,000,000 'a's)
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly handles a very large input string. The input string does not contain "map" or "pie" substrings, and the function should return 0.

# Test 9
**Input**:
```
1
1000000
map...map (1,000,000 'map's)
```
**Output**:
```
999999
```
**Explanation**: This test case checks if the function correctly handles a very large input string with multiple occurrences of the same substring. The input string contains multiple "map" substrings, and the function should return 999999, indicating that 999999 characters need to be removed to make the string beautiful.

# Test 10
**Input**:
```
1
1000000
pie...pie (1,000,000 'pie's)
```
**Output**:
```
999999
```
**Explanation**: This test case checks if the function correctly handles a very large input string with multiple occurrences of the same substring. The input string contains multiple "pie" substrings, and the function should return 999999, indicating that 999999 characters need to be removed to make the string beautiful.