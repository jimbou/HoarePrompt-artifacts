Here are the comprehensive test cases for the given problem:

**Basic Test Cases**

# Test 1: Ugly string with "pie" substring
**Input**:
```
9
mmapnapie
```
**Output**:
```
2
```
**Explanation**: The string contains the substring "pie", which makes it ugly. Removing 2 characters ("p" and "i") makes it beautiful.

# Test 2: Ugly string with "map" substring
**Input**:
```
8
mappppie
```
**Output**:
```
2
```
**Explanation**: The string contains the substring "map", which makes it ugly. Removing 2 characters ("m" and "a") makes it beautiful.

# Test 3: Beautiful string
**Input**:
```
9
azabazapi
```
**Output**:
```
0
```
**Explanation**: The string does not contain any of the substrings "pie" or "map", making it beautiful.

**Edge Test Cases**

# Test 4: Empty string
**Input**:
```
0
```
**Output**:
```
0
```
**Explanation**: An empty string is considered beautiful.

# Test 5: Single character string
**Input**:
```
1
p
```
**Output**:
```
0
```
**Explanation**: A single character string is considered beautiful.

# Test 6: String with multiple "pie" substrings
**Input**:
```
18
mapmapmapmapmapmap
```
**Output**:
```
6
```
**Explanation**: The string contains multiple "map" substrings, which makes it ugly. Removing 6 characters ("m" and "a" from each "map") makes it beautiful.

# Test 7: String with multiple "map" substrings
**Input**:
```
11
pppiepieeee
```
**Output**:
```
2
```
**Explanation**: The string contains multiple "pie" substrings, which makes it ugly. Removing 2 characters ("p" and "i") makes it beautiful.

# Test 8: Long string with no "pie" or "map" substrings
**Input**:
```
1000000
abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz...
```
**Output**:
```
0
```
**Explanation**: The string does not contain any of the substrings "pie" or "map", making it beautiful.

# Test 9: Long string with "pie" substring
**Input**:
```
1000000
abcdefghijklmnopqrstuvwxyzpieabcdefghijklmnopqrstuvwxyz...
```
**Output**:
```
2
```
**Explanation**: The string contains the substring "pie", which makes it ugly. Removing 2 characters ("p" and "i") makes it beautiful.

# Test 10: Long string with "map" substring
**Input**:
```
1000000
abcdefghijklmnopqrstuvwxyzmapabcdefghijklmnopqrstuvwxyz...
```
**Output**:
```
2
```
**Explanation**: The string contains the substring "map", which makes it ugly. Removing 2 characters ("m" and "a") makes it beautiful.

These test cases cover various scenarios, including basic cases with "pie" and "map" substrings, edge cases with empty strings, single character strings, and long strings with and without the substrings.