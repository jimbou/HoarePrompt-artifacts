# Test 1
**Input**:
```
1
9
mmapnapie
```
**Output**:
```
2
```
**Explanation**: This test case checks the basic functionality of the function. The input string "mmapnapie" contains both "map" and "pie" substrings, so the function should return 2, indicating that at least 2 characters need to be removed to make the string beautiful.

# Test 2
**Input**:
```
1
9
azabazapi
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly identifies a beautiful string. The input string "azabazapi" does not contain any "map" or "pie" substrings, so the function should return 0.

# Test 3
**Input**:
```
1
8
mappppie
```
**Output**:
```
2
```
**Explanation**: This test case checks if the function correctly handles multiple occurrences of "map" and "pie" substrings. The input string "mappppie" contains both "map" and "pie" substrings, so the function should return 2.

# Test 4
**Input**:
```
1
18
mapmapmapmapmapmap
```
**Output**:
```
6
```
**Explanation**: This test case checks if the function correctly handles a large number of "map" substrings. The input string "mapmapmapmapmapmap" contains 6 "map" substrings, so the function should return 6.

# Test 5
**Input**:
```
1
1
p
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly handles a single character input. The input string "p" does not contain any "map" or "pie" substrings, so the function should return 0.

# Test 6
**Input**:
```
1
11
pppiepieeee
```
**Output**:
```
2
```
**Explanation**: This test case checks if the function correctly handles multiple occurrences of "pie" substrings. The input string "pppiepieeee" contains 2 "pie" substrings, so the function should return 2.

# Test 7
**Input**:
```
1
0
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly handles an empty input string. The input string is empty, so the function should return 0.

# Test 8
**Input**:
```
1
1000000
a
```
**Output**:
```
0
```
**Explanation**: This test case checks if the function correctly handles a large input string with a single character. The input string "a" repeated 1000000 times does not contain any "map" or "pie" substrings, so the function should return 0.

# Test 9
**Input**:
```
1
1000000
map
```
**Output**:
```
1
```
**Explanation**: This test case checks if the function correctly handles a large input string with a single "map" substring. The input string "map" repeated 1000000 times contains 1000000 "map" substrings, so the function should return 1000000.

# Test 10
**Input**:
```
1
1000000
pie
```
**Output**:
```
1
```
**Explanation**: This test case checks if the function correctly handles a large input string with a single "pie" substring. The input string "pie" repeated 1000000 times contains 1000000 "pie" substrings, so the function should return 1000000.