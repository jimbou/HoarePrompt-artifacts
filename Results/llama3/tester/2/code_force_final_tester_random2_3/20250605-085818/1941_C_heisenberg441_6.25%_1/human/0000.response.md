Here are the comprehensive test cases for the problem:

**Basic Test Cases**

# Test 1: Ugly string with "pie" and "map"
**Input**:
```
9
mmapnapie
```
**Output**: 
```
2
```
**Explanation**: The string contains both "pie" and "map", so we need to remove at least 2 characters to make it beautiful.

# Test 2: Beautiful string
**Input**:
```
9
azabazapi
```
**Output**: 
```
0
```
**Explanation**: The string does not contain "pie" or "map", so it is already beautiful.

# Test 3: Ugly string with multiple "pie"s
**Input**:
```
11
pppiepieeee
```
**Output**: 
```
2
```
**Explanation**: The string contains multiple "pie"s, but we only need to remove 2 characters to make it beautiful.

**Edge Test Cases**

# Test 4: Empty string
**Input**:
```
0
```
**Output**: 
```
0
```
**Explanation**: An empty string is considered beautiful, so no characters need to be removed.

# Test 5: Single character string
**Input**:
```
1
p
```
**Output**: 
```
0
```
**Explanation**: A single character string cannot contain "pie" or "map", so it is already beautiful.

# Test 6: String with only "pie"s
**Input**:
```
10
piepiepiepie
```
**Output**: 
```
8
```
**Explanation**: The string contains only "pie"s, so we need to remove all but 2 characters to make it beautiful.

# Test 7: String with only "map"s
**Input**:
```
12
mapmapmapmapmap
```
**Output**: 
```
10
```
**Explanation**: The string contains only "map"s, so we need to remove all but 2 characters to make it beautiful.

# Test 8: Very long string
**Input**:
```
1000000
abcdefghijklmnopqrstuvwxyz... (1000000 characters)
```
**Output**: 
```
0
```
**Explanation**: A very long string without "pie" or "map" is already beautiful.

# Test 9: String with "pie" and "map" at the beginning and end
**Input**:
```
12
pieabcdefghijklmnopqrstuvwxyzmap
```
**Output**: 
```
2
```
**Explanation**: The string contains "pie" and "map" at the beginning and end, so we need to remove at least 2 characters to make it beautiful.

These test cases cover various scenarios, including basic cases with "pie" and "map", edge cases with empty strings, single character strings, and very long strings, as well as cases with multiple "pie"s and "map"s.