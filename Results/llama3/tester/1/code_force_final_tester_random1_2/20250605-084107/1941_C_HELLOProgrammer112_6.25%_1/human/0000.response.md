# Test 1
**Input**: 
```
1
9
mmapnapie
```
**Output**: 
```
2
```
**Explanation**: This test case checks the basic functionality of the function. The string "mmapnapie" contains both "map" and "pie" substrings, so the function should return 2, which is the minimum number of characters to remove to make the string beautiful.

# Test 2
**Input**: 
```
1
9
azabazapi
```
**Output**: 
```
0
```
**Explanation**: This test case checks if the function correctly identifies a beautiful string. The string "azabazapi" does not contain "map" or "pie" substrings, so the function should return 0.

# Test 3
**Input**: 
```
1
8
mappppie
```
**Output**: 
```
2
```
**Explanation**: This test case checks if the function correctly handles overlapping substrings. The string "mappppie" contains both "map" and "pie" substrings, and the function should return 2.

# Test 4
**Input**: 
```
1
18
mapmapmapmapmapmap
```
**Output**: 
```
6
```
**Explanation**: This test case checks if the function correctly handles multiple occurrences of the same substring. The string "mapmapmapmapmapmap" contains multiple "map" substrings, and the function should return 6.

# Test 5
**Input**: 
```
1
1
p
```
**Output**: 
```
0
```
**Explanation**: This test case checks if the function correctly handles a single character input. The string "p" does not contain "map" or "pie" substrings, so the function should return 0.

# Test 6
**Input**: 
```
1
11
pppiepieeee
```
**Output**: 
```
2
```
**Explanation**: This test case checks if the function correctly handles multiple occurrences of the same substring with other characters in between. The string "pppiepieeee" contains multiple "pie" substrings, and the function should return 2.

# Test 7
**Input**: 
```
1
0
```
**Output**: 
```
0
```
**Explanation**: This test case checks if the function correctly handles an empty string input. The function should return 0.

# Test 8
**Input**: 
```
1
1000000
a
```
**Output**: 
```
0
```
**Explanation**: This test case checks if the function correctly handles a large input string with a single character repeated. The string "a" repeated 1000000 times does not contain "map" or "pie" substrings, so the function should return 0.

# Test 9
**Input**: 
```
1
1000000
mapmapmapmapmapmap
```
**Output**: 
```
600000
```
**Explanation**: This test case checks if the function correctly handles a large input string with multiple occurrences of the same substring. The string "mapmapmapmapmapmap" repeated 1000000 times contains multiple "map" substrings, and the function should return 600000.

# Test 10
**Input**: 
```
1
1000000
pppiepieeee
```
**Output**: 
```
200000
```
**Explanation**: This test case checks if the function correctly handles a large input string with multiple occurrences of the same substring with other characters in between. The string "pppiepieeee" repeated 1000000 times contains multiple "pie" substrings, and the function should return 200000.