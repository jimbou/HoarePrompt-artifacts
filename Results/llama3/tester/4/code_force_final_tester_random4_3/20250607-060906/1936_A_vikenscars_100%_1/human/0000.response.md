Here are the comprehensive test cases for the given problem:

**1. Basic Test Cases**

# Test 1
**Input**: 
```
2
4
```
**Output**: 
```
? 0 2 3 1
? 1 1 2 3
? 1 2 0 3
! 3 2
```
**Description**: This test case checks the basic functionality of the program with a small input size (n = 4).

# Test 2
**Input**: 
```
2
8
```
**Output**: 
```
? 0 4 7 3
? 1 1 2 3
? 1 2 0 3
! 7 3
```
**Description**: This test case checks the basic functionality of the program with a moderate input size (n = 8).

**2. Edge Test Cases**

# Test 3
**Input**: 
```
1
2
```
**Output**: 
```
! 0 1
```
**Description**: This test case checks the program's behavior with the minimum possible input size (n = 2).

# Test 4
**Input**: 
```
1
10000
```
**Output**: 
```
? 0 5000 9999 4999
? 1 1 2 3
? 1 2 0 3
! 9999 4999
```
**Description**: This test case checks the program's behavior with the maximum possible input size (n = 10000).

# Test 5
**Input**: 
```
1
3
```
**Output**: 
```
? 0 2 1 0
? 1 1 2 0
? 1 2 0 1
! 2 1
```
**Description**: This test case checks the program's behavior with an odd input size (n = 3).

# Test 6
**Input**: 
```
1
1
```
**Output**: 
```
! 0 0
```
**Description**: This test case checks the program's behavior with an input size of 1.

Note that these test cases cover various scenarios, including small and large input sizes, odd and even input sizes, and edge cases like n = 1 and n = 10000.