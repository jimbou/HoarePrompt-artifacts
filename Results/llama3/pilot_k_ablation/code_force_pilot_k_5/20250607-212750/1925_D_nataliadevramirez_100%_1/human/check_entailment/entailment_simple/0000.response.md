Reasoning: 

The given Python program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

The program first reads the number of test cases T, then for each test case, it reads the number of children n, the number of pairs of friends p, and the number of excursions k. It then calculates the sum S of the friendship values of all pairs of friends.

The program then calculates the total number of possible pairs of children C, which is n*(n-1)//2.

The program then calculates the numerator num and denominator den of the expected value. The numerator is the sum of the products of the number of pairs of friends, the number of excursions, and the sum of the friendship values, minus the product of the number of pairs of friends and the number of excursions, plus twice the product of the number of excursions, the total number of possible pairs of children, and the sum of the friendship values. The denominator is twice the square of the total number of possible pairs of children.

The program then calculates the greatest common divisor g of the numerator and denominator, and divides both the numerator and denominator by g to simplify the fraction.

The program then calculates the modular inverse of the denominator den modulo MOD, and multiplies the numerator num by the modular inverse to get the expected value.

Finally, the program prints the expected value.

Correctness: **True**