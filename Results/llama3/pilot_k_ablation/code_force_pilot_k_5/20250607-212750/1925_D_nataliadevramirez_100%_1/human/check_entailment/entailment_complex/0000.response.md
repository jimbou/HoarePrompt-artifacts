Reasoning: 

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses modular arithmetic to avoid overflow and to calculate the result modulo 10^9+7. The program also correctly handles the case where the number of pairs of friends is 0, in which case the expected value is 0.

The program's logic is as follows:

- It first calculates the sum of the initial friendship values of all pairs of friends.
- It then calculates the total number of possible pairs of children, which is n*(n-1)/2.
- It calculates the numerator of the expected value, which is the sum of the initial friendship values multiplied by the number of excursions, plus the number of pairs of friends multiplied by the number of excursions squared, minus the number of pairs of friends multiplied by the number of excursions.
- It calculates the denominator of the expected value, which is the total number of possible pairs of children squared.
- It calculates the greatest common divisor of the numerator and the denominator and divides both by it to simplify the fraction.
- It calculates the modular inverse of the denominator modulo 10^9+7 and multiplies the numerator by it to get the final result.
- It prints the final result modulo 10^9+7.

The program's time complexity is O(T*(m+log(n))), where T is the number of test cases, m is the number of pairs of friends, and n is the number of children. The space complexity is O(1), as the program only uses a constant amount of space to store the input and the result.

Correctness: **True**