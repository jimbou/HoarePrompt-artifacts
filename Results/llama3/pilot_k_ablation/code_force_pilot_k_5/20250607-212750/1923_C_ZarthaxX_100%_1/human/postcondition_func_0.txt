This function processes a series of test cases from standard input. Each test case consists of an integer n and q, followed by a list of n integers, and then q queries, each consisting of two integers l and r. The function calculates the number of 1's and the sum of the integers in the list up to each index, and then uses this information to answer each query. For each query, it checks if the sum of the integers in the range [l, r] is greater than or equal to twice the number of 1's in the range plus the length of the range minus the number of 1's in the range. If the condition is met, it prints 'YES', otherwise it prints 'NO'. The function processes all queries for each test case and then moves on to the next test case.