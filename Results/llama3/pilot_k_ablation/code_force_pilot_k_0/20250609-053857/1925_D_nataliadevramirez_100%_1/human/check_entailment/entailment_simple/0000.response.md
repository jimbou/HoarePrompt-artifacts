Reasoning:

The given Python program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program correctly reads the input values, calculates the sum of the initial friendship values (S), and the total number of possible pairs (C).

The program then calculates the numerator (num) and denominator (den) of the expected value expression. The numerator represents the sum of the products of the number of pairs, the number of excursions, and the sum of the initial friendship values, minus the product of the number of pairs and the number of excursions, plus twice the product of the number of excursions, the total number of possible pairs, and the sum of the initial friendship values. The denominator represents the square of the total number of possible pairs.

The program correctly calculates the greatest common divisor (g) of the numerator and denominator, divides both by g to simplify the fraction, and then calculates the modular inverse of the denominator using the pow function with a negative exponent.

Finally, the program calculates the result of the expression (num * den) % MOD, where MOD is 10^9 + 7, and prints the result.

Based on the problem description and the execution states of the program, the program correctly implements the required logic to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Correctness: **True**