Reasoning:

The given program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. Here's a step-by-step breakdown of the program's correctness:

1. The program first reads the number of test cases T and then iterates over each test case.

2. For each test case, it reads the number of children n, the number of pairs of friends p, and the number of excursions k.

3. It then calculates the sum S of the initial friendship values of all pairs of friends.

4. The total number of possible pairs of children is calculated as C = n * (n - 1) // 2.

5. The program then calculates the numerator and denominator of the expected value. The numerator is calculated as num = p * k * k - p * k + 2 * k * C * S, and the denominator is calculated as den = 2 * C * C.

6. The program then calculates the greatest common divisor (gcd) of the numerator and denominator using the math.gcd function and divides both the numerator and denominator by the gcd to simplify the fraction.

7. The denominator is then inverted using the pow function with a negative exponent, which is equivalent to calculating the modular multiplicative inverse.

8. Finally, the program calculates the expected value by multiplying the numerator with the inverted denominator and taking the result modulo 10^9 + 7.

The program's logic is correct, and it accurately implements the mathematical formula for the expected value of the sum of friendship values. However, there are a few potential issues:

- The program assumes that the input values are valid and does not perform any error checking. If the input values are invalid (e.g., negative numbers), the program may produce incorrect results or crash.

- The program uses the math.gcd function to calculate the greatest common divisor, which may not be the most efficient approach for large numbers.

- The program uses the pow function to calculate the modular multiplicative inverse, which may not be the most efficient approach for large numbers.

Despite these potential issues, the program's logic is correct, and it should produce the correct results for valid input values.

Correctness: **True**