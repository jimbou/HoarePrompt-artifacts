Correctness: **False**.

The program does not work correctly for the case when the query is equal to the length of the array. In this case, the program will return an incorrect result because it does not handle this edge case properly.

For example, if the input is:

5 10
1 1
1 2
2 1
1 3
2 3
1 2 3 4 5 6 14 15 16 20

The program will return:

1 2 1 2 3 1 2 3 1 3

However, the correct output should be:

1 2 1 2 3 1 2 3 1 3 1

The program does not handle the case when the query is equal to the length of the array, which is 20 in this case. Therefore, the program is incorrect.