Functionality: This function takes a non-empty string of balanced parentheses as input and returns a new string consisting of the same characters, sorted by the balance of the parentheses at each position and then by the position in descending order. The function does not modify the input string and only rearranges its characters based on the specified sorting criteria.