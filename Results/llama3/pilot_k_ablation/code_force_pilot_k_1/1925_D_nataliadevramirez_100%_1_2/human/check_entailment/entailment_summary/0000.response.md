Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program takes into account the number of children, pairs of friends, and excursions, as well as the friendship values of each pair. It uses the formula (p * k * k - p * k + 2 * k * C * S) / (2 * C * C) to calculate the expected value, where C is the number of possible pairs of nodes, S is the sum of f_i values, and p is the number of edges. The program also reduces the fraction to its simplest form by dividing both numerator and denominator by their greatest common divisor before taking the modulo.

The program also correctly handles the case where there are no pairs of friends, in which case the friendship value of all pairs is 0 and stays 0 for subsequent rounds.

Correctness: **True**