Reasoning:

The given program is correct. Here's why:

1.  The program correctly reads the input for each test case, which consists of the number of containers `n` and the amounts of water in each container `a_1, a_2, ..., a_n`.
2.  It calculates the total amount of water `total_water` and the target amount of water in each container `target` by dividing the total amount of water by the number of containers `n`. This is correct because the problem statement guarantees that the sum of `a_i` is divisible by `n`.
3.  The program then iterates over the containers and calculates the cumulative balance `current_balance` by adding the difference between the current container's water amount and the target amount. If the cumulative balance ever becomes negative, it means that there is not enough water in the previous containers to redistribute to the current container, so the program sets `possible` to `False` and breaks out of the loop.
4.  After iterating over all containers, the program checks the value of `possible`. If it's `True`, it means that the cumulative balance never became negative, so it's possible to redistribute the water to make all containers have the same amount. In this case, the program prints 'YES'. Otherwise, it prints 'NO'.

Correctness: **True**