Reasoning:

The given program is correct. Here's why:

1. The program correctly reads the input for each test case, which consists of the number of children (n), pairs of friends (m), and excursions (k), followed by m lines containing the indices of the pair of children who are friends and their friendship value.

2. The program calculates the sum of the friendship values (S) for all pairs of friends.

3. The program calculates the total number of possible pairs of children (C), which is n*(n-1)/2.

4. The program calculates the numerator (num) and denominator (den) of the expected value of the sum of friendship values of all k pairs chosen for the excursions. The numerator is calculated as p*k*k - p*k + 2*k*C*S, where p is the number of pairs of friends. The denominator is calculated as 2*C*C.

5. The program calculates the greatest common divisor (g) of the numerator and denominator and divides both by g to simplify the fraction.

6. The program calculates the modular multiplicative inverse of the denominator (den) modulo 10^9+7 using the pow function with a negative exponent.

7. The program calculates the final answer (ans) by multiplying the numerator by the modular multiplicative inverse of the denominator and taking the result modulo 10^9+7.

8. The program prints the final answer for each test case.

The program correctly implements the mathematical formula for the expected value of the sum of friendship values of all k pairs chosen for the excursions, and it correctly handles the modular arithmetic to avoid overflow.

Correctness: **True**