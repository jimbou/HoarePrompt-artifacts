Reasoning:

The given program is designed to solve a problem involving the expected value of the sum of friendship values of all k pairs chosen for excursions. The program reads multiple test cases, calculates a value based on the input, and prints the result for each test case, modulo 1000000007.

Upon analyzing the program, it appears to correctly implement the required logic. It calculates the sum of friendship values (S), the total number of possible pairs (C), and then uses these values to compute the expected value. The program also handles the modulo operation correctly to avoid overflow.

However, there is a logical error in the calculation of the expected value. The correct formula for the expected value should be:

Expected Value = (Sum of friendship values of all pairs) / (Total number of possible pairs)

But in the given program, the formula used is:

num = p * k * k - p * k + 2 * k * C * S
den = 2 * C * C

This formula is incorrect, and it does not match the problem description.

Therefore, the correctness of the program is **False**.

Correctness: **False**