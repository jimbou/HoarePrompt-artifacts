Reasoning:

The given Python program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program correctly calculates the sum of the initial friendship values (S) and the total number of possible pairs (C). It then calculates the numerator (num) and denominator (den) of the expected value.

The numerator is calculated as p * k * k - p * k + 2 * k * C * S, which represents the sum of the products of the number of pairs, the number of excursions, and the sum of the initial friendship values.

The denominator is calculated as 2 * C * C, which represents the total number of possible pairs squared.

The program then calculates the greatest common divisor (g) of the numerator and denominator and divides both by g to simplify the fraction.

Finally, the program calculates the modular inverse of the denominator (den) modulo MOD (1000000007) and multiplies it with the numerator (num) to get the final answer.

The program correctly handles the case where there are no pairs of friends (p = 0) and the case where there is only one pair possible.

Correctness: **True**