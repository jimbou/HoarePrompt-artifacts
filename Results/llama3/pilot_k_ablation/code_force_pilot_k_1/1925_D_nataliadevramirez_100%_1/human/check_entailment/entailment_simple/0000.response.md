Reasoning:

The given Python program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Here's a breakdown of the program's correctness:

1. The program correctly reads the input values for n, m, and k, and the friendship values for each pair of friends.

2. It calculates the total sum of friendship values (S) by summing up the friendship values of all pairs.

3. It calculates the total number of possible pairs (C) using the formula n*(n-1)/2.

4. It calculates the numerator (num) and denominator (den) of the expected value using the correct formulas.

5. It calculates the greatest common divisor (g) of num and den, and divides both num and den by g to simplify the fraction.

6. It calculates the modular multiplicative inverse of den modulo MOD using the pow function with a negative exponent.

7. It calculates the final answer by multiplying num with the modular multiplicative inverse of den, and takes the result modulo MOD.

8. It prints the final answer.

The program correctly handles the case where there are no pairs of friends (m = 0), and it correctly calculates the expected value for the given examples.

Correctness: **True**