Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the numerator and denominator of the expected value.

The numerator is calculated as `num = p * k * k - p * k + 2 * k * C * S`, where `p` is the number of pairs of friends, `k` is the number of excursions, `C` is the total number of possible pairs, and `S` is the sum of the friendship values of all pairs. However, this calculation is incorrect because it does not take into account the fact that the friendship value of a pair increases by 1 for each excursion.

The correct calculation for the numerator should be `num = p * k * (k + 1) / 2 + 2 * k * C * S`, which takes into account the increasing friendship value of each pair.

The denominator is calculated as `den = 2 * C * C`, which is correct.

Therefore, the program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions, and the correctness is **False**.