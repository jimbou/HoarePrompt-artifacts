Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the numerator `num`. The correct calculation should be `num = p * k * k - p * k + 2 * k * C * S + k * (k - 1) * p * p`, where `C` is the total number of possible pairs and `S` is the sum of the initial friendship values. The additional term `k * (k - 1) * p * p` accounts for the increase in friendship values when a pair of friends is chosen more than once.

A counterexample is when `n = 3`, `m = 2`, `k = 2`, and the pairs are `(1, 2)` with friendship value `1` and `(2, 3)` with friendship value `1`. The expected value of the sum of friendship values should be `2 + 2 + 2 = 6`, but the program will output `4`.