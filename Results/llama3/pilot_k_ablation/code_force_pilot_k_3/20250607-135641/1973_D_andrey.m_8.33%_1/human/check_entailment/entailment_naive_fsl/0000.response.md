Correctness: **False**.

The program does not handle the case when the maximum value `max_val` is not found in the first loop of `func_3()`. In this case, the program will not be able to find a valid `m` in the second loop, but it will still call `func_2(-1)` which is incorrect. The program should instead continue to the next test case or handle this case differently.

Additionally, the program does not check if the input `n` and `k` are valid (i.e., `1 <= k <= n <= 10^4`). If the input is invalid, the program may produce incorrect results or crash.

The program also does not handle the case when the function `func_1()` returns `n+1` (i.e., no valid `r` exists). In this case, the program should handle this case differently, for example, by continuing to the next test case or by returning an error.

The program also does not handle the case when the function `func_2()` returns `-1` (i.e., the answer is incorrect). In this case, the program should handle this case differently, for example, by continuing to the next test case or by returning an error.

Overall, the program does not handle all possible cases and edge cases, and therefore it is incorrect.