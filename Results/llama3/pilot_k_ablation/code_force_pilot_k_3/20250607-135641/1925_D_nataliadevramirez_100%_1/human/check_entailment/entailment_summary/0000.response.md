Reasoning:

The given program is correct. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions. The program uses modular arithmetic to avoid overflow and calculates the modular multiplicative inverse of the denominator to get the final result.

The program correctly reads the input, calculates the sum of the friendship values, computes the value of C, calculates the numerator and denominator of the fraction, reduces the fraction, calculates the modular multiplicative inverse of the denominator, and multiplies the numerator by the modular multiplicative inverse of the denominator.

The program also correctly handles the case where there are no pairs of friends (i.e., m = 0) and the case where the number of excursions is 1.

Correctness: **True**