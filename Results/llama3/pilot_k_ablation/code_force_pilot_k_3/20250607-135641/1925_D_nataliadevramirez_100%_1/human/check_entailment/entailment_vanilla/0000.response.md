Reasoning:

The given program is designed to calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. Here's a step-by-step breakdown of the program's correctness:

1. The program first reads the number of test cases T and then iterates over each test case.

2. For each test case, it reads the number of children n, the number of pairs of friends p, and the number of excursions k.

3. It then calculates the sum S of the initial friendship values of all pairs of friends.

4. The program calculates the total number of possible pairs of children C, which is n*(n-1)/2.

5. The program then calculates the numerator num and denominator den of the expected value. The numerator is calculated as p*k*k - p*k + 2*k*C*S, and the denominator is 2*C*C.

6. The program calculates the greatest common divisor g of num and den and divides both by g to simplify the fraction.

7. The program then calculates the modular multiplicative inverse of den modulo MOD (10^9+7) using the pow function with a negative exponent.

8. Finally, the program calculates the expected value by multiplying num with the modular multiplicative inverse of den and takes the result modulo MOD.

The program's logic and calculations are correct based on the problem description. It correctly calculates the expected value of the sum of friendship values of all k pairs chosen for the excursions.

Correctness: **True**