Correctness: **False**.

The program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions. The issue lies in the calculation of the numerator and denominator.

The numerator should be the sum of the products of the friendship values and the number of times each pair is chosen, which is not correctly calculated in the program. The program multiplies the sum of friendship values by k*k, which is incorrect.

The denominator should be the total number of possible pairs, which is correctly calculated as n*(n-1)//2. However, the program does not correctly calculate the expected value by dividing the numerator by the denominator.

A correct approach would be to calculate the expected value by summing the products of the friendship values and the probabilities of each pair being chosen, and then dividing by the total number of possible pairs.

For example, consider the case where n=3, m=2, k=2, and the friendship values are 1 and 2. The program would calculate the numerator as 2*2*2 - 2*2 + 2*3*2*2 = 24, and the denominator as 2*3*3 = 18. However, the correct expected value would be (1*1/3 + 2*1/3) + (1*1/3 + 2*1/3) = 2, which is not equal to 24/18.

Therefore, the program does not correctly calculate the expected value of the sum of friendship values of all k pairs chosen for the excursions, and the correctness is **False**.